<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Portfolio of Khademul</title>

          <!-- Favicon -->
    <link rel="icon" type="image/png" href="assets/favicon.png">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="assets/styles.css">

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: { extend: {} },
    }
  </script>
  <!-- //email send cdn emailjs -->
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>


  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- AOS Animations -->
  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.4/dist/aos.css">
  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js" defer></script>
</head>
<body class="min-h-screen flex flex-col font-poppins">

  <!-- Header -->
  <div id="header"></div>

  <!-- Main Content Wrapper -->
  <main class="flex-1 mb-4">

    <!-- Page Heading -->
    <section class="text-center mt-20 md:mt-20">
      <div class="text-center mb-8">
        <h2 class="text-3xl md:text-4xl font-bold mb-4">
          My <span class="bg-gradient-to-r from-indigo-500 via-pink-500 to-purple-500 bg-clip-text text-transparent">Projects</span>
        </h2>
        <div class="w-20 h-1 bg-pink-500 dark:bg-yellow-400 mx-auto rounded-full"></div>
      </div>
    </section>

    <!-- Projects Container -->


        <section class="py-10 bg-gray-100 dark:bg-gray-800">
         <div class="container mx-auto px-6">

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="projects">
                <!-- Project  -->
            </div>
          </div>

                      <!-- Pagination Controls -->
            <div class="flex justify-center items-center mt-8 space-x-2" id="pagination-controls">
                <button id="prev-page" class="px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-400 dark:hover:bg-gray-500 transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed">
                    <i class="fas fa-chevron-left mr-2"></i>Previous
                </button>
                
                <div class="flex space-x-1" id="page-numbers">
                    <!-- Page buttons will be generated dynamically -->
                </div>
                
                <button id="next-page" class="px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-400 dark:hover:bg-gray-500 transition duration-300">
                    Next<i class="fas fa-chevron-right ml-2"></i>
                </button>
            </div>
        </section>


    <div id="contact"></div>
  </main>

  <!-- Footer -->
  <div id="footer"></div>



  <!-- Supabase JS -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  // ---------------- Supabase Initialization ----------------
  const SUPABASE_URL = 'https://alvsikeqnudebronhzym.supabase.co';
  const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFsdnNpa2VxbnVkZWJyb25oenltIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI2OTA3NDUsImV4cCI6MjA3ODI2Njc0NX0.VveUI3DRSSWxrkQMoOBeQ9Vyov3EbPdFMDeBpM-w7yM';
  const db = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  // ---------------- Pagination Variables ----------------
  const projectsPerPage = 3;
  let currentPage = 1;
  let totalPages = 1;
  let allProjects = [];

  // ---------------- Load Header & Footer ----------------
  async function loadSection(id, file) {
    try {
      const res = await fetch(file);
      const html = await res.text();
      document.getElementById(id).innerHTML = html;
    } catch (err) {
      console.error(`Failed to load ${file}:`, err);
    }
  }

  loadSection('header', 'include/header.html').then(() => initThemeToggle());
  loadSection('footer', 'include/footer.html');

  // ---------------- Theme Toggle ----------------
  function initThemeToggle() {
    const htmlEl = document.documentElement;
    const themeBtn = document.getElementById('theme-toggle');
    const moonIcon = document.getElementById('moon-icon');
    const sunIcon = document.getElementById('sun-icon');

    // Set initial theme
    const savedTheme = localStorage.getItem('theme');
    if(savedTheme === 'dark') htmlEl.classList.add('dark');

    function updateIcons() {
      if(htmlEl.classList.contains('dark')) {
        moonIcon?.classList.remove('hidden');
        sunIcon?.classList.add('hidden');
      } else {
        moonIcon?.classList.add('hidden');
        sunIcon?.classList.remove('hidden');
      }
    }
    updateIcons();

    themeBtn?.addEventListener('click', () => {
      htmlEl.classList.toggle('dark');
      localStorage.setItem('theme', htmlEl.classList.contains('dark') ? 'dark' : 'light');
      updateIcons();
    });
  }

  // ---------------- Load Projects with Pagination ----------------
  async function fetchProjects() {
    try {
      const { data, error } = await db
        .from('projects')
        .select('*')
        .order('id', { ascending: false });

      if (error) throw error;

      allProjects = data || [];
      totalPages = Math.ceil(allProjects.length / projectsPerPage);
      renderPage(currentPage);
      renderPagination();
    } catch (err) {
      console.error('Error fetching projects:', err);
      document.getElementById('projects').innerHTML = 
        `<p class="col-span-3 text-center text-red-500">Failed to load projects.</p>`;
    }
  }

  function renderPage(page) {
    const container = document.getElementById('projects');
    container.innerHTML = '';

    const start = (page - 1) * projectsPerPage;
    const end = start + projectsPerPage;

    allProjects.slice(start, end).forEach(p => {
      const tags = p.tags ? p.tags.split(',') : [];
      const tagHTML = tags.map(tag => `<span class="text-xs px-3 py-1 bg-gray-300 dark:bg-gray-600 rounded-full">${tag.trim()}</span>`).join('');

      const card = `
          <div class="project-card bg-white dark:bg-gray-700 rounded-xl overflow-hidden shadow-md hover:shadow-xl transition duration-300" data-page="1">

              <div class="relative h-48 overflow-hidden">
                  <img src="${p.image || 'https://placehold.co/600x400?text=No+Image'}"
                          alt="Project 1"
                          class="w-full h-full object-cover transition duration-500 hover:scale-110">
                  <div class="absolute inset-0 bg-indigo-600 dark:bg-indigo-800 bg-opacity-80 flex items-center justify-center opacity-0 hover:opacity-100 transition duration-300">
                  <a href="view.html?id=${p.id}"
                      class="text-white text-lg font-medium px-4 py-2 border-2 border-white rounded-lg
                              hover:bg-white hover:text-indigo-600 dark:hover:text-indigo-300 transition duration-300">
                      View Project
                  </a>
                  </div>
              </div>
              <div class="p-6">
                  <h3 class="text-xl font-semibold mb-2">
                      <a href="view.html?id=${p.id}" class="hover:underline">
                          ${p.title}
                      </a>
                  </h3>
                  <p class="text-gray-600 dark:text-gray-300 mb-4">
                      ${p.description}
                  </p>

                  <div class="flex flex-wrap gap-2 text-black">${tagHTML}</div>
              </div>
          </div>
      `;
      container.insertAdjacentHTML('beforeend', card);
    });
  }

  function renderPagination() {
    const pageNumbers = document.getElementById('page-numbers');
    pageNumbers.innerHTML = '';

    for (let i = 1; i <= totalPages; i++) {
      const btn = document.createElement('button');
      btn.textContent = i;
      btn.className = 'px-3 py-1 rounded border hover:bg-gray-200 dark:hover:bg-gray-600';
      if (i === currentPage) btn.classList.add('bg-gray-400', 'dark:bg-gray-500');

      btn.addEventListener('click', () => {
        currentPage = i;
        renderPage(currentPage);
        renderPagination();
      });
      pageNumbers.appendChild(btn);
    }

    document.getElementById('prev-page').disabled = currentPage === 1;
    document.getElementById('next-page').disabled = currentPage === totalPages;
  }

  document.getElementById('prev-page')?.addEventListener('click', () => {
    if (currentPage > 1) {
      currentPage--;
      renderPage(currentPage);
      renderPagination();
    }
  });

  document.getElementById('next-page')?.addEventListener('click', () => {
    if (currentPage < totalPages) {
      currentPage++;
      renderPage(currentPage);
      renderPagination();
    }
  });
        // âœ… Contact form script
    const sections = [
    { id: 'contact', file: 'contact' }
  ];

  sections.forEach(section => {
    fetch(`${section.file}.html`)
      .then(res => res.text())
      .then(data => {
        document.getElementById(section.id).innerHTML = data;

        // âœ… Contact form logic
        if (section.id === 'contact') {
        // Initialize EmailJS
        emailjs.init("0PfCUdQGydg8YIyMa"); // ðŸ”¹ replace with your EmailJS public key

        const contactForm = document.getElementById('contactForm');
        if (contactForm) {
          contactForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const subject = document.getElementById('subject').value;
            const message = document.getElementById('message').value;

            // === 1ï¸âƒ£ Save to Supabase ===
            const { error } = await db
              .from('messages')
              .insert([{ name, email, subject, message }]);

            if (error) {
              alert('âŒ Error saving message: ' + error.message);
              return;
            }

            // 2ï¸âƒ£ Prepare EmailJS parameters
            const emailParams = {
              name: name,
              email: email,
              subject: subject,
              message: message,
              time: new Date().toLocaleString()
            };

            try {
              // Send message to YOU
              await emailjs.send('service_yxru6db', 'template_cogdtl9', emailParams);

              // Send confirmation to USER
              await emailjs.send('service_yxru6db', 'template_lpxs3fp', emailParams);

              alert('âœ… Your message has been sent successfully!');
              contactForm.reset();

            } catch (error) {
              console.error("EmailJS error:", error);
              alert('âš ï¸ Failed to send message.');
            }
          });
        }
      }
    })
      .catch(err => console.error(`${section.file} load error:`, err));
  });


  // ---------------- Initialize ----------------
  document.addEventListener('DOMContentLoaded', () => {
    fetchProjects();

    // Initialize AOS
    if(window.AOS) AOS.init();
  });
</script>


</body>
</html>
